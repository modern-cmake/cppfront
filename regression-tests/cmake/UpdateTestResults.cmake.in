set(SOURCE "${TEST_NAME}.cpp2")
set(EXPECTED_FILE "test-results/${TEST_NAME}.cpp")
set(EXPECTED_FILE_OUTPUT "test-results/${SOURCE}.output")
set(FILE_OUTPUT "@CMAKE_CURRENT_BINARY_DIR@/${TEST_NAME}/output")
if (NOT "${TEST_NAME}" MATCHES [[.*-error$]])
    set(COMMAND_ERROR_IS_FATAL "COMMAND_ERROR_IS_FATAL" "ANY")
endif ()
execute_process(
    COMMAND "@CPPFRONT_EXECUTABLE@" "${SOURCE}" ${EXTRA_FLAGS} -o "${EXPECTED_FILE}"
    WORKING_DIRECTORY "@REGRESSION_TESTS_DIR@"
    OUTPUT_FILE "${FILE_OUTPUT}"
    ERROR_FILE "${FILE_OUTPUT}"
    ${COMMAND_ERROR_IS_FATAL}
)
execute_process(
    COMMAND "${CMAKE_COMMAND}" -E copy_if_different "${FILE_OUTPUT}" "@REGRESSION_TESTS_DIR@/${EXPECTED_FILE_OUTPUT}")
